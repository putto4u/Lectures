ë³¸ ê°€ì´ë“œëŠ” IaC(Infrastructure as Code) ì›ì¹™ì— ë”°ë¼ Windows í˜¸ìŠ¤íŠ¸ì™€ ê°€ìƒ ë¨¸ì‹  í™˜ê²½ì„ ìë™ êµ¬ì¶•í•˜ëŠ” ì „ì²´ ê³µì •ì„ ë‹¤ë£¹ë‹ˆë‹¤. ê° ëª…ë ¹ì¤„ì˜ ì™¼ìª½ì—ëŠ” ì‹¤í–‰í•´ì•¼ í•  í„°ë¯¸ë„ í™˜ê²½ì„ ëª…ì‹œí•˜ì˜€ìŠµë‹ˆë‹¤.

---

## ğŸ› ï¸ ì „ì²´ êµ¬ì¶• ì ˆì°¨ ë° ì‹¤í–‰ í™˜ê²½ ìš”ì•½

| ë‹¨ê³„ | ì‘ì—… êµ¬ë¶„ | ìˆ˜í–‰ ë„êµ¬ | **ì‹¤í–‰ í„°ë¯¸ë„ í™˜ê²½** |
| --- | --- | --- | --- |
| **1ë‹¨ê³„** | **í˜¸ìŠ¤íŠ¸ ê¸°ì´ˆ ì„¤ì •** | PowerShell | **Windows PowerShell (ê´€ë¦¬ì)** |
| **2ë‹¨ê³„** | **ì œì–´ ë…¸ë“œ êµ¬ì¶•** | Bash (WSL) | **WSL (Ubuntu) í„°ë¯¸ë„** |
| **3ë‹¨ê³„** | **Windows ìë™í™”** | Ansible | **WSL (Ubuntu) í„°ë¯¸ë„** |
| **4ë‹¨ê³„** | **ê°€ìƒ ë¨¸ì‹  êµ¬ì¶•** | Vagrant | **Windows PowerShell** (ë˜ëŠ” WSL) |
| **5ë‹¨ê³„** | **ìµœì¢… í™•ì¸** | SSH / Login | **ê° í•´ë‹¹ í™˜ê²½** |

---

## 1ë‹¨ê³„: Windows í˜¸ìŠ¤íŠ¸ ê¸°ì´ˆ í™˜ê²½ ì„¤ì •

Windows ì‹œìŠ¤í…œì˜ ê¸°ëŠ¥ì„ í™œì„±í™”í•˜ê³  ì œì–´ í†µë¡œë¥¼ í™•ë³´í•©ë‹ˆë‹¤.

1. **Chocolatey(íŒ¨í‚¤ì§€ ê´€ë¦¬ì) ì„¤ì¹˜**
* **[ì‹¤í–‰ í™˜ê²½: Windows PowerShell (ê´€ë¦¬ì)]**


```powershell
Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))

```


2. **WSL2 ë° Ubuntu ì„¤ì¹˜** (ì‹¤í–‰ í›„ PC ì¬ë¶€íŒ… í•„ìš”)
* **[ì‹¤í–‰ í™˜ê²½: Windows PowerShell (ê´€ë¦¬ì)]**


```powershell
wsl --install
# ë¦¬ë¶€íŒ… í›„
wsl -l -v

```


3. **WinRM(ì›ê²© ê´€ë¦¬) í™œì„±í™”** (Ansible ì ‘ì†ìš©)
* **[ì‹¤í–‰ í™˜ê²½: Windows PowerShell (ê´€ë¦¬ì)]**


```powershell
$url = "https://raw.githubusercontent.com/ansible/ansible/devel/examples/scripts/ConfigureRemotingForAnsible.ps1"
$file = "$env:temp\ConfigureRemotingForAnsible.ps1"
(New-Object -TypeName System.Net.WebClient).DownloadFile($url, $file)
powershell.exe -ExecutionPolicy Bypass -File $file

```



**404 ì—ëŸ¬ë°œìƒì‹œ ì•„ë˜ ë‚´ìš©ì„ ëª¨ë‘ copyí•˜ì—¬ C:\winRM.ps1 ì´ë¼ëŠ” íŒŒì¼ì„ ë§Œë“¤ì–´ ë„£ìŠµë‹ˆë‹¤.**
```
<#
.SYNOPSIS
    Configures WinRM for Ansible on Windows.
#>
$opt = "AllowUnencrypted"
$val = "true"

# WinRM ì„œë¹„ìŠ¤ í™•ì¸ ë° ì‹œì‘
if (!(Get-Service WinRM -ErrorAction SilentlyContinue)) {
    Write-Host "WinRM ì„œë¹„ìŠ¤ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
    exit
}

Write-Host "WinRM ì„¤ì •ì„ ì‹œì‘í•©ë‹ˆë‹¤..."

# WinRM ê¸°ë³¸ ì„¤ì • ë° ë°©í™”ë²½ ì˜ˆì™¸ ì¶”ê°€
winrm quickconfig -q
winrm set winrm/config/service "@{$opt=`"$val`"}"
winrm set winrm/config/service/auth "@{"Basic"=`"true`"}"

# ë°©í™”ë²½ í¬íŠ¸ 5985, 5986 ê°œë°©
netsh advfirewall firewall add rule name="WinRM-HTTP" dir=in action=allow protocol=TCP localport=5985
netsh advfirewall firewall add rule name="WinRM-HTTPS" dir=in action=allow protocol=TCP localport=5986

Write-Host "WinRM ì„¤ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ Ansibleì—ì„œ ì ‘ì† ê°€ëŠ¥í•©ë‹ˆë‹¤."
```



---

## 2ë‹¨ê³„: WSL ë‚´ë¶€ Ansible ì œì–´ í™˜ê²½ êµ¬ì¶•

Windows ë‚´ì— ì„¤ì¹˜ëœ ë¦¬ëˆ…ìŠ¤(WSL) í™˜ê²½ì—ì„œ ì œì–´ ì—”ì§„ì„ ì„¤ì •í•©ë‹ˆë‹¤.

1. **Ansible ì„¤ì¹˜**
* **[ì‹¤í–‰ í™˜ê²½: WSL (Ubuntu) í„°ë¯¸ë„]**


```bash
sudo apt update && sudo apt install software-properties-common -y
sudo add-apt-repository --yes --update ppa:ansible/ansible
sudo apt install ansible python3-pip -y

```


2. **Windows ì ‘ì† ë¼ì´ë¸ŒëŸ¬ë¦¬(pywinrm) ì„¤ì¹˜**
* **[ì‹¤í–‰ í™˜ê²½: WSL (Ubuntu) í„°ë¯¸ë„]**


```bash
pip3 install pywinrm

```



---

## 3ë‹¨ê³„: Windows ë§ˆìŠ¤í„° í™˜ê²½ ìë™ êµ¬ì¶• (Ansible)

WSLì—ì„œ Windows í˜¸ìŠ¤íŠ¸ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì„¤ì • ëª…ë ¹ì„ ë‚´ë¦½ë‹ˆë‹¤.

1. **`setup_windows.yml` í”Œë ˆì´ë¶ ì‘ì„± ë° ì‹¤í–‰**
* **[ì‹¤í–‰ í™˜ê²½: WSL (Ubuntu) í„°ë¯¸ë„]**


```yaml
# íŒŒì¼ ìƒì„±: nano setup_windows.yml
---
- name: Windows Host Master Setup
  hosts: all
  vars:
    ansible_connection: winrm
    ansible_winrm_server_cert_validation: ignore
  tasks:
    - name: 1. ê´€ë¦¬ì ê¶Œí•œì˜ master ê³„ì • ìƒì„±
      community.windows.win_user:
        name: master
        password: "jj968096"
        groups:
          - Administrators
        state: present

    - name: 2. Chocolateyë¥¼ ì´ìš©í•œ í•„ìˆ˜ í”„ë¡œê·¸ë¨ ì„¤ì¹˜
      community.windows.win_chocolatey:
        name:
          - virtualbox
          - vagrant
          - visualstudiocode
          - git
        state: present

```


* **ì‹¤í–‰ ëª…ë ¹**: `ansible-playbook -i [ìœˆë„ìš°IP], setup_windows.yml`



---

## 4ë‹¨ê³„: ê°€ìƒ ë¨¸ì‹ (VM) ìë™ ìƒì„± (Vagrant)

ì½”ë“œë¥¼ í†µí•´ ê°€ìƒ ë¨¸ì‹  í•˜ë“œì›¨ì–´ì™€ ì´ˆê¸° OS ì„¤ì •ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

1. **`Vagrantfile` ì‘ì„± ë° VM ê¸°ë™**
* **[ì‹¤í–‰ í™˜ê²½: Windows PowerShell]** (íŒŒì¼ì´ ì €ì¥ëœ í´ë”ë¡œ ì´ë™ í›„)


```ruby
Vagrant.configure("2") do |config|
  config.vm.box = "ubuntu/noble64" # 24.04 LTS

  config.vm.provider "virtualbox" do |vb|
    vb.name = "Master_Control_VM"
    vb.memory = "2048"
  end

  config.vm.provision "shell", inline: <<-SHELL
    useradd -m -s /bin/bash master
    echo "master:12345678" | chpasswd
    usermod -aG sudo master
    echo "root:12345678" | chpasswd
    sed -i 's/PasswordAuthentication no/PasswordAuthentication yes/' /etc/ssh/sshd_config
    systemctl restart ssh
  SHELL
end

```


* **ì‹¤í–‰ ëª…ë ¹**: `vagrant up`



---

## 5ë‹¨ê³„: ìµœì¢… í™•ì¸ ë° ì ‘ì†

1. **Windows ë§ˆìŠ¤í„° ê³„ì • í™•ì¸**
* **[í™•ì¸ ë°©ë²•: Windows ì„¤ì •]**: 'ì‚¬ìš©ì ì •ë³´'ì—ì„œ `master` ê³„ì • ìƒì„± ì—¬ë¶€ í™•ì¸.


2. **VM SSH ì ‘ì† í…ŒìŠ¤íŠ¸**
* **[ì‹¤í–‰ í™˜ê²½: Windows PowerShell ë˜ëŠ” WSL]**


```bash
ssh master@localhost -p 2222
# ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸: 12345678

```


3. **VM Root ê¶Œí•œ íšë“ í™•ì¸**
* **[ì‹¤í–‰ í™˜ê²½: SSH ì ‘ì†ëœ VM ë‚´ë¶€]**


```bash
su - root
# ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸: 12345678

```



---

Next Step: ì¸ë²¤í† ë¦¬(Inventory) íŒŒì¼ êµ¬ì„± ë° ìë™ ì ‘ì† ì„¤ì •

ëª…ë ¹ì¤„ ì‹¤í–‰ í™˜ê²½ | ì•¤ì„œë¸” í”Œë ˆì´ë¶ | ë² ì´ê·¸ë€íŠ¸ ê¸°ë™ | ìœˆë„ìš° ì›ê²© ì œì–´ ì™„ë£Œ

---

ìš”ì²­í•˜ì‹  ëŒ€ë¡œ ê° ì‘ì—… ë‹¨ê³„ë³„ë¡œ ì–´ë–¤ í„°ë¯¸ë„ í™˜ê²½ì—ì„œ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•´ì•¼ í•˜ëŠ”ì§€ ëª…í™•íˆ êµ¬ë¶„í•˜ì—¬ ì¬êµ¬ì„±í–ˆìŠµë‹ˆë‹¤. ì§€ì¹¨ì— ë”°ë¼ ê°•ì‚¬ë‚˜ í•™ìƒ ë“±ì˜ ì–¸ê¸‰ì„ ë°°ì œí•˜ê³  ê¸°ìˆ ì ì¸ ì ˆì°¨ì— ì§‘ì¤‘í•˜ì—¬ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

íŠ¹íˆ **1ë‹¨ê³„ëŠ” ë°˜ë“œì‹œ Windows PowerShell(ê´€ë¦¬ì)**ì—ì„œ, **2~3ë‹¨ê³„ëŠ” WSL**ì—ì„œ ì‹¤í–‰í•´ì•¼ í•¨ì„ ê°•ì¡°í•˜ì˜€ìŠµë‹ˆë‹¤.

ê´€ë¦¬ì ê¶Œí•œ í™•ì¸ | í„°ë¯¸ë„ í™˜ê²½ êµ¬ë¶„ | ì•¤ì„œë¸”-ìœˆë„ìš° ì—°ë™ | ê°€ìƒí™” ìë™í™” ì™„ë£Œ
